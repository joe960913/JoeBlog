<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Async/Await</title><link rel="shortcut icon" href="/images/ghost.jpg"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css"><script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script><meta name="generator" content="Hexo 4.0.0"></head><body><nav class="main-nav"><a href="/">Home</a><a href="/archives">Archives</a><a href="/about">About Me</a></nav><div class="profile"><section id="wrapper"><header id="header"><a href="/"><img class="2x" id="avatar" src="/images/ghost.jpg"></a><h1>Redamancy_13</h1><h2></h2></header></section></div><section class="post" id="wrapper"><article><header><h1>Async/Await</h1><h2 class="headline">Nov 20, 2019 7:40·
1.1k words
·
6 minutes read<span class="tags"></span></h2></header><section id="post-body"><h1 id="Async-Await"><a href="#Async-Await" class="headerlink" title="Async/Await"></a>Async/Await</h1><p>Let’s talk about Async/Await !</p>
<h2 id="What-is-Async-Await"><a href="#What-is-Async-Await" class="headerlink" title="What is Async/Await?"></a>What is Async/Await?</h2><ul>
<li>The newest way to write asynchronous code in JavaScript.</li>
<li>It is non blocking (just like promises and callbacks).</li>
<li>Async/Await was created to simplify the process of working with and writing chained promises.</li>
<li>Async functions return a Promise. If the function throws an error, the Promise will be rejected. If the function returns a value, the Promise will be resolved.</li>
</ul>
<h2 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h2><p>Writing an async function is quite simple. You just need to add the <code>async</code> keyword prior to <code>function</code>:</p>
<pre><code>// Normal Functionfunction add(x,y){
  return x + y;
}// Async Functionasync function add(x,y){
  return x + y;
}</code></pre><h2 id="Await"><a href="#Await" class="headerlink" title="Await"></a>Await</h2><p>Async functions can make use of the <code>await</code> expression. This will pause the <code>async</code> function and wait for the Promise to resolve prior to moving on.</p>
<h2 id="Example-Time"><a href="#Example-Time" class="headerlink" title="Example Time"></a>Example Time</h2><p>Enough talk. To understand what all of this means, lets look at an example! First we’re going to create some code using promises. Once we’ve got something working, we’ll rewrite our function using async/await so you can see just how much simpler it is!</p>
<blockquote>
<p>If you’re using Google Chrome, be sure to follow along by typing in the code into your developer console. You can open the console by pressing Ctrl+Shift+J (Windows / Linux) or Cmd+Opt+J (Mac).</p>
</blockquote>
<p>Consider the below code:</p>
<pre><code>function doubleAfter2Seconds(x) {
  return new Promise(resolve =&gt; {
    setTimeout(() =&gt; {
      resolve(x * 2);
    }, 2000);
  });
}</code></pre><p>In this code we have a function called <code>doubleAfter2Seconds</code>. This function will take a number as input and will resolve two seconds later with the number doubled.</p>
<p>We can invoke our function and pass in the number 10 to try it out. To do this, we’ll call our function while passing in <code>10</code>. Then, after the promise has resolved, we’ll take our returned value and log it to the console. Here’s what this would look like:</p>
<pre><code>doubleAfter2Seconds(10).then((r) =&gt; {
  console.log(r);
});</code></pre><p>Awesome!</p>
<p>But what if we want to run a few different values through our function and add the result? Unfortunately, we cant just add our invocations together and log them:</p>
<pre><code>let sum =   doubleAfter2Seconds(10)
          + doubleAfter2Seconds(20)
          + doubleAfter2Seconds(30);
console.log(sum);// undefined</code></pre><p>The problem with the above code is it doesn’t actually wait for our promises to resolve before logging to the console.</p>
<p>One possible solution is to set up a promise chain. To do this we’ll create a new function called <code>addPromise</code>. Our function will take an input value, and will return a Promise. Here’s what the boilerplate code looks like:</p>
<pre><code>function addPromise(x){
  return new Promise(resolve =&gt; {    // Code goes here...   
    // resolve()  });
}</code></pre><p>Awesome. Now we can add in our calls to our <code>doubleAfter2Seconds</code> function. Once we’re done, we can resolve with our new sum. In this example we should be returning <code>x + 2*a + 2*b + 2*c</code>. Here’s the code:</p>
<pre><code>function addPromise(x){
  return new Promise(resolve =&gt; {
    doubleAfter2Seconds(10).then((a) =&gt; {
      doubleAfter2Seconds(20).then((b) =&gt; {
        doubleAfter2Seconds(30).then((c) =&gt; {
          resolve(x + a + b + c);
        })
      })
    })
  });
}</code></pre><p>Lets walk through the code again, line by line.</p>
<ul>
<li>First, we create our function <code>addPromise</code>. This function accepts one parameter.</li>
<li>Next, we create our <code>new Promise</code> that we’ll be returning. Note that for the sake of simplicity, we’re not handling rejections/errors.</li>
<li>Next we invoke <code>doubleAfter2Seconds</code> for the first time, passing in a value of <code>10</code>. Two seconds later, the return value of <code>20</code> will be returned to the <code>a</code> variable.</li>
<li>We invoke <code>doubleAfter2Seconds</code> again, this time passing in a value of <code>20</code>. Two seconds later, the return value of <code>40</code> will be returned to the <code>b</code> variable.</li>
<li>We invoke <code>doubleAfter2Seconds</code> one final time, this time passing in a value of <code>30</code>. Two seconds later, the return value of <code>60</code> will be returned to the <code>c</code> variable.</li>
<li>Finally, we resolve our Promise with the value of <code>10 + 20 + 40 + 60</code> or <code>130</code>.</li>
</ul>
<h2 id="Switching-from-Promises-to-Async-Await"><a href="#Switching-from-Promises-to-Async-Await" class="headerlink" title="Switching from Promises to Async/Await."></a>Switching from Promises to Async/Await.</h2><p>Awesome! Now lets see just how much easier we could write the above code with Async/Await!</p>
<p>Remove the <code>addPromise</code> function, and create a new function named <code>addAsync</code>. This function will have the exact same purpose as our <code>addPromise</code> did. When you create your <code>addPromise</code> function, make use of the <code>async</code> keyword. Here’s what that looks like:</p>
<pre><code>async function addAsync(x) {  // code here...}</code></pre><p>Now that you’ve created an async function, we can make use of the <code>await</code> keyword which will pause our code until the Promise has resolved. Here’s how easy that is:</p>
<pre><code>async function addAsync(x) {
  const a = await doubleAfter2Seconds(10);
  const b = await doubleAfter2Seconds(20);
  const c = await doubleAfter2Seconds(30);
  return x + a + b + c;
}</code></pre><p>As you can see, we’re still making use of the same <code>doubleAfter2Seconds</code> function. Similarly, we’ll be invoking our <code>addAsync()</code> function and passing in the value of <code>10</code>. Upon completion, we log the resulting value. Let’s walk through this step-by-step:</p>
<ul>
<li>First we call <code>addAsync(10)</code> passing in the value of <code>10</code>.</li>
<li>Next, we get the value of <code>a</code> on line 10. Since the <code>await</code> keyword is used, our function pauses for two seconds while we wait for the promise to resolve. Once the promise resolves, <code>a = 20</code>.</li>
</ul>
<pre><code>const a = await doubleAfter2Seconds(10);</code></pre><ul>
<li>Next, we get the value of <code>b</code> on line 11. Since the <code>await</code> keyword is used, our function pauses for two seconds while we wait for the promise to resolve. Once the promise resolves, <code>b = 40</code>.</li>
</ul>
<pre><code>const b = await doubleAfter2Seconds(20);</code></pre><ul>
<li>Next, we get the value of <code>c</code> on line 12. Since the <code>await</code> keyword is used, our function pauses for two seconds while we wait for the promise to resolve. Once the promise resolves, <code>c = 60</code>.</li>
</ul>
<pre><code>const c = await doubleAfter2Seconds(30);</code></pre><ul>
<li>Finally, we can return the value of <code>x + a + b + c</code>. Since we passed in <code>10</code> as our single parameter, we are returning the value of <code>10 + 20 + 40 + 60</code>.</li>
<li>A full six seconds later, our <code>console.log(sum)</code>is finally run. The value of <code>10 + 20 + 40 + 60</code> is passed in, and <code>130</code> is logged to the console.</li>
</ul>
<p>And that’s it! You’ve just created an asynchronous function in JavaScript!</p>
<p><strong>As you can see, since Async functions return a Promise, they can be used interchangeably with Promises very easily. Our code is also so much cleaner and easier to read when we use Async/Await instead of long Promise chain.</strong></p>
</section><nav id="post-nav"><span class="prev"><a href="/about-e-target-adn-e-currentTarget/"><span class="arrow">←</span>Newer Posts</a></span><span class="next"><a href="/Promise/">Older Posts<span class="arrow">→</span></a></span></nav><section><div id="disqus_thread"><noscript>'Please enable JavaScript to view the'<a href="http://disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript></div></section><script>(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());</script></article></section><footer id="footer"><div id="social"><a class="symbol" href="https://github.com/joe960913" target="_blank" rel="noopener"><i class="fa fa-github"></i></a><p class="small">You still have time</p></div></footer><script>hljs.initHighlightingOnLoad();</script></body></html>